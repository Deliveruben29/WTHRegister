# ğŸ›¡ï¸ Payroll Guardian - Feature Specification

## ğŸ¯ Mission Statement

**"Empowering workers through AI-assisted payroll analysis and tax optimization"**

Payroll Guardian uses AI to help workers understand their paychecks, detect payroll errors, and optimize their tax returns. We believe financial literacy and protection from labor abuse should be accessible to everyone, not just those who can afford expensive accountants.

---

## ğŸ’¡ Core Value Proposition

### Problems We Solve:
1. **Information Asymmetry** - Workers don't understand their paychecks or deductions
2. **Unreliable Intermediaries** - Traditional tax advisors often don't act in workers' best interests
3. **Hidden Abuse** - Incorrect deductions that go unnoticed
4. **Complex Legislation** - Labor laws too complicated to navigate alone
5. **Cost Barriers** - Professional advice is expensive and inaccessible

### Our Solution:
- ğŸ¤– **AI-Powered Analysis** using Google Gemini
- ğŸ“ **Educational Approach** - Teach, don't just tell
- ğŸ’° **Affordable Pricing** - Free tier + premium at worker-friendly prices
- ğŸŒ **Multi-Country Support** - Localized to each country's labor laws
- ğŸ“± **Always Available** - 24/7 access from any device

---

## ğŸ—ï¸ Technical Architecture

### Phase 1: MVP (Q1 2025)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          User Profile                  â”‚
â”‚  - Country (ES, MX, AR, CO, etc.)     â”‚
â”‚  - Contract Type (full-time, etc.)    â”‚
â”‚  - Base Salary                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        Upload Payslip                 â”‚
â”‚  - PDF upload                         â”‚
â”‚  - Image upload (phone camera)        â”‚
â”‚  - OCR extraction (Cloud Vision)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         AI Analysis (Gemini)          â”‚
â”‚  - Parse payroll data                 â”‚
â”‚  - Verify deductions by law           â”‚
â”‚  - Detect irregularities              â”‚
â”‚  - Generate recommendations           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        Educational Report              â”‚
â”‚  âœ“ Correct deductions                 â”‚
â”‚  âš ï¸ Potential errors                   â”‚
â”‚  ğŸ’¡ Tax optimization tips              â”‚
â”‚  ğŸ“š Plain language explanations        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Tech Stack

**Backend:**
- Database: Supabase (profiles, payroll_records)
- AI: Google Gemini 2.0 Flash (analysis)
- OCR: Google Cloud Vision API
- Storage: Supabase Storage (payslip PDFs)

**Frontend:**
- React (existing stack)
- PDF.js (PDF viewer)
- Chart.js (visualizations)

**External APIs:**
- Tax rate APIs (per country)
- Currency conversion (optional)

---

## ğŸ“Š Database Schema

### New Tables

```sql
-- User country and settings
ALTER TABLE profiles ADD COLUMN country VARCHAR(2) DEFAULT 'ES';
ALTER TABLE profiles ADD COLUMN contract_type VARCHAR(50);
ALTER TABLE profiles ADD COLUMN base_salary DECIMAL(10,2);

-- Payroll records
CREATE TABLE payroll_records (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  user_id UUID REFERENCES auth.users NOT NULL,
  upload_date TIMESTAMPTZ NOT NULL DEFAULT NOW(),
  period_start DATE NOT NULL,
  period_end DATE NOT NULL,
  
  -- Extracted data
  gross_salary DECIMAL(10,2),
  net_salary DECIMAL(10,2),
  deductions JSONB, -- All deductions as JSON
  
  -- AI Analysis
  analysis_status VARCHAR(20), -- pending, completed, error
  ai_findings JSONB, -- AI analysis results
  
  -- File storage
  file_url TEXT,
  file_type VARCHAR(10) -- pdf, jpg, png
);

-- RLS policies
ALTER TABLE payroll_records ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Users can view own payroll" 
  ON payroll_records FOR SELECT 
  USING (auth.uid() = user_id);

CREATE POLICY "Users can insert own payroll" 
  ON payroll_records FOR INSERT 
  WITH CHECK (auth.uid() = user_id);
```

---

## ğŸŒ Country-Specific Tax Rules

### Tax Rules Configuration

```javascript
// src/utils/taxRules.js
export const TAX_RULES = {
  ES: {
    name: 'EspaÃ±a',
    currency: 'EUR',
    irpf: {
      // Personal Income Tax brackets
      brackets: [
        { min: 0, max: 12450, rate: 19 },
        { min: 12450, max: 20200, rate: 24 },
        { min: 20200, max: 35200, rate: 30 },
        { min: 35200, max: 60000, rate: 37 },
        { min: 60000, max: 300000, rate: 45 },
        { min: 300000, max: Infinity, rate: 47 }
      ]
    },
    social_security: {
      // Seguridad Social contributions
      contingencias_comunes: 4.70,
      unemployment: 1.55,
      training: 0.10,
      total_employee: 6.35 // Total % for employee
    },
    min_wage: 1134, // Monthly minimum wage
    max_social_security_base: 4495.50 // Monthly cap
  },
  
  MX: {
    name: 'MÃ©xico',
    currency: 'MXN',
    isr: {
      // ISR (Impuesto Sobre la Renta) monthly
      brackets: [
        { min: 0, max: 644.58, rate: 1.92, credit: 0 },
        { min: 644.59, max: 5470.92, rate: 6.40, credit: 12.38 },
        { min: 5470.93, max: 9614.66, rate: 10.88, credit: 249.24 },
        { min: 9614.67, max: 11176.62, rate: 16.00, credit: 735.00 },
        { min: 11176.63, max: 13381.47, rate: 17.92, credit: 985.68 },
        { min: 13381.48, max: 26988.50, rate: 21.36, credit: 1446.99 },
        { min: 26988.51, max: 42537.58, rate: 23.52, credit: 3063.72 },
        { min: 42537.59, max: 81211.25, rate: 30.00, credit: 6382.80 },
        { min: 81211.26, max: 108281.67, rate: 32.00, credit: 8006.16 },
        { min: 108281.68, max: 324845.01, rate: 34.00, credit: 10171.88 },
        { min: 324845.02, max: Infinity, rate: 35.00, credit: 13421.73 }
      ]
    },
    imss: {
      // IMSS (Social Security) rates
      employee_percentage: 2.375,
      min_wage: 248.93 // Daily minimum wage
    }
  },
  
  AR: {
    name: 'Argentina',
    currency: 'ARS',
    // To be implemented
  },
  
  CO: {
    name: 'Colombia',
    currency: 'COP',
    // To be implemented
  }
  
  // Expandable to more countries
};
```

---

## ğŸ¤– AI Integration (Gemini)

### Analysis Prompt Template

```javascript
// src/utils/payrollAnalyzer.js
export const analyzePayroll = async (payrollData, country) => {
  const taxRules = TAX_RULES[country];
  
  const prompt = `
You are an expert labor law consultant in ${taxRules.name}.

PAYROLL DATA:
- Gross Salary: ${payrollData.gross} ${taxRules.currency}
- Net Salary: ${payrollData.net} ${taxRules.currency}
- Deductions Applied: ${JSON.stringify(payrollData.deductions, null, 2)}
- Period: ${payrollData.period}

TAX RULES FOR ${country}:
${JSON.stringify(taxRules, null, 2)}

ANALYZE:
1. Are the deductions CORRECT according to ${country} labor law?
2. Calculate what the correct deductions SHOULD be
3. Identify any errors, irregularities, or suspicious items
4. Provide tax optimization suggestions
5. Explain everything in SIMPLE, worker-friendly language

Respond in JSON format:
{
  "status": "correct" | "warning" | "error",
  "calculated_deductions": {
    "irpf": 123.45,
    "social_security": 67.89,
    "other": 0
  },
  "findings": [
    {
      "type": "error" | "warning" | "info",
      "title": "Short title",
      "description": "Detailed explanation",
      "impact": "How much money does this affect?"
    }
  ],
  "suggestions": [
    {
      "category": "tax_optimization" | "legal_rights" | "financial_planning",
      "title": "Suggestion title",
      "description": "How to implement",
      "potential_savings": 0
    }
  ],
  "education": {
    "what_is_irpf": "Simple explanation...",
    "what_is_social_security": "Simple explanation...",
    "your_net_explained": "Simple explanation of how we got from gross to net..."
  }
}
`;

  const result = await gemini.generateContent(prompt);
  return JSON.parse(result.text);
};
```

---

## ğŸ’° Business Model

### Freemium Pricing

**Free Tier** ğŸ†“
- 2 payroll analyses per month
- Basic error detection
- Country-specific tax rules
- Educational content

**Premium Tier** ğŸ’ (â‚¬7.99/month or â‚¬79/year)
- âœ… Unlimited payroll analyses
- âœ… Historical tracking (12 months)
- âœ… Proactive alerts (irregular deductions detected)
- âœ… Annual tax projection
- âœ… Job change simulator
- âœ… Priority support
- âœ… Export all data

**Enterprise/Union Tier** ğŸ¤ (Custom pricing)
- Bulk licenses for union members
- Custom integrations
- Dedicated support
- White-label option

### Revenue Projections

**Conservative:**
- 10,000 active users
- 5% conversion to premium (500 users)
- â‚¬7.99/month Ã— 500 = **â‚¬3,995/month** = **â‚¬47,940/year**

**Optimistic:**
- 100,000 active users
- 10% premium conversion (10,000 users)
- **â‚¬799,000/year**

**With B2B:**
- 5 unions Ã— 1,000 members Ã— â‚¬3/member = **â‚¬180,000/year additional**

---

## ğŸ“± User Experience Flow

### 1. Onboarding

```
Welcome to Payroll Guardian! ğŸ›¡ï¸

Let's set up your profile:

1. What country are you working in?
   [Dropdown: Spain, Mexico, Argentina, etc.]

2. What type of contract do you have?
   [Full-time, Part-time, Freelance, etc.]

3. What's your monthly base salary? (optional)
   [Input field]

[Continue]
```

### 2. Upload Payslip

```
Upload Your Payslip ğŸ“„

Drag and drop your payslip here, or click to browse
[Upload area]

Supported formats: PDF, JPG, PNG
Privacy: Your documents are encrypted and never shared

[Upload] [Cancel]
```

### 3. Analysis Results

```
Payroll Analysis - March 2025 âœ“

STATUS: âš ï¸ Warning - Possible Irregularity Detected

SUMMARY:
Your gross salary: â‚¬2,500.00
Your net salary: â‚¬2,089.50
Total deductions: â‚¬410.50 (16.42%)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FINDINGS (2)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âš ï¸ IRPF Deduction Seems High        â”‚
â”‚    Expected: â‚¬280.00                â”‚
â”‚    Actual: â‚¬312.50                  â”‚
â”‚    Difference: -â‚¬32.50 âš ï¸           â”‚
â”‚                                     â”‚
â”‚    [Learn More]                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ“ Social Security is Correct        â”‚
â”‚    Breakdown: 4.70% + 1.55% + 0.10% â”‚
â”‚    Total: â‚¬157.50 âœ“                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SUGGESTIONS (3)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ’¡ Tax Deduction Opportunities      â”‚
â”‚    You may be eligible for...       â”‚
â”‚    [Read More]                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[Download Report] [Ask Question] [Upload Another]
```

---

## ğŸ“ Educational Content

### Knowledge Base Topics

1. **Understanding Your Payslip**
   - Gross vs Net Salary
   - Types of Deductions
   - What is IRPF/ISR?
   - Social Security explained

2. **Your Legal Rights**
   - Minimum wage laws
   - Overtime regulations
   - Vacation pay rules
   - Severance entitlements

3. **Tax Optimization**
   - Deductions you can claim
   - How to file taxes correctly
   - Common mistakes to avoid
   - When to seek professional help

4. **Financial Planning**
   - Budgeting with your paycheck
   - Emergency fund basics
   - Retirement planning

---

## ğŸš€ Implementation Roadmap

### Phase 1: MVP (Month 1-2)
- [ ] Design UI for country selection
- [ ] Implement payslip upload (PDF/Image)
- [ ] Integrate Google Cloud Vision for OCR
- [ ] Build database schema for payroll_records
- [ ] Create tax rules for Spain (ES)
- [ ] Integrate Gemini for basic analysis
- [ ] Build analysis report UI
- [ ] Deploy and test with 10 beta users

### Phase 2: Multi-Country (Month 3-4)
- [ ] Add Mexico (MX) tax rules
- [ ] Add Argentina (AR) tax rules
- [ ] Add Colombia (CO) tax rules
- [ ] Improve AI prompts for accuracy
- [ ] Add historical tracking
- [ ] Build comparison charts

### Phase 3: Premium Features (Month 5-6)
- [ ] Implement Stripe payments
- [ ] Build paywall for premium features
- [ ] Add proactive alerts system
- [ ] Annual tax projection calculator
- [ ] Job change simulator
- [ ] Export functionality

### Phase 4: Scale & Partnerships (Month 7-12)
- [ ] SEO optimization
- [ ] Content marketing (blog, videos)
- [ ] Approach labor unions for partnerships
- [ ] B2B sales pipeline
- [ ] Mobile app (React Native)
- [ ] Expand to 10+ countries

---

## ğŸ“Š Success Metrics

### User Metrics:
- Monthly Active Users (MAU)
- Payslips analyzed per month
- User retention rate (30, 60, 90 days)
- Premium conversion rate

### Impact Metrics:
- Total errors detected
- Total money saved for workers
- User satisfaction (NPS score)
- Educational content engagement

### Business Metrics:
- Monthly Recurring Revenue (MRR)
- Customer Acquisition Cost (CAC)
- Lifetime Value (LTV)
- Churn rate

---

## ğŸ›¡ï¸ Privacy & Security

### Data Protection:
- âœ… End-to-end encryption for uploads
- âœ… GDPR compliant (EU users)
- âœ… No data selling, ever
- âœ… Automatic deletion after 90 days (free tier)
- âœ… User controls data export/deletion
- âœ… SOC 2 Type II certification (future)

### Transparency:
- Open source AI prompts
- Clear privacy policy in simple language
- Regular security audits
- Transparent about limitations

---

## ğŸ’ª Social Impact Goals

### Year 1:
- Help 10,000 workers understand their paychecks
- Detect â‚¬100,000+ in payroll errors
- Publish 50 educational articles

### Year 3:
- Help 500,000 workers across 10 countries
- Detect â‚¬5M+ in errors and save workers money
- Partner with 20+ labor unions
- Launch mobile app with 100k+ downloads

### Year 5:
- Become the #1 payroll guardian app globally
- Help 5M+ workers
- Expand to 30+ countries
- Influence labor law reform through data insights

---

## ğŸ¯ Next Steps

1. **Validate MVP** - Show demo to 20 workers, get feedback
2. **Legal Review** - Consult labor law expert for Spain
3. **Build Alpha** - Complete Phase 1 in 6 weeks
4. **Beta Test** - 100 users for 1 month
5. **Launch Public** - Marketing campaign
6. **Iterate** - Based on user feedback

---

## ğŸ“ Team Needs

To execute this vision, we'll need:
- **1 Full-stack Developer** (you! ğŸ‘‹)
- **1 Labor Law Advisor (Spain)** - Part-time consultant
- **1 AI/ML Specialist** - Fine-tune Gemini prompts
- **1 Designer/UX** - Polish the experience
- **1 Marketing/Community Manager** - Grow user base

Budget: Start with â‚¬5k-10k for initial development and legal consultation.

---

## ğŸŒŸ Why This Will Succeed

1. **Real Problem** - Millions of workers need this
2. **Timing** - AI makes this possible NOW
3. **Mission-Driven** - Workers will champion it
4. **Scalable** - One codebase, many countries
5. **Sustainable** - Clear path to profitability
6. **Impactful** - Measurable social good

---

**Let's build Payroll Guardian and protect workers everywhere.** ğŸ›¡ï¸

---

## Appendix: Competitive Analysis

**Competitors:**
- Traditional tax advisors (Expensive, slow)
- GestorÃ­as (Conflicts of interest)
- Tax software (Too complex)
- Payroll companies (B2B only)

**Our Advantage:**
- AI-powered (fast, 24/7)
- Worker-focused (aligned incentives)
- Simple UX (accessible to everyone)
- Affordable (â‚¬7.99/mo vs â‚¬50-200/mo)
- Educational (empowerment, not dependency)
